
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accueil - BRS Riche 2</title>

<!-- CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<style>
body { font-family: 'Segoe UI', Arial, sans-serif; margin:0; padding:0; background: #f4f7fb; color: #333; }
#home-container { max-width: 1100px; margin:auto; padding:0 16px 60px; }
.hero { background: linear-gradient(135deg,#0d47a1,#1976d2); color:#fff; text-align:center; padding:64px 20px; border-radius:14px; margin:24px 0 40px; }
.hero h1 { font-size:2.2em; margin:0 0 12px; }
.hero p { font-size:1.1em; margin:0 0 22px; }
.btn { display:inline-block; padding:14px 24px; border-radius:12px; font-weight:bold; text-decoration:none; margin:6px; transition: transform .2s, background .2s; box-shadow:0 6px 14px rgba(0,0,0,0.15); }
.btn-primary { background:#ffcc00; color:#0d47a1; }
.btn-outline { color:#fff; text-decoration:underline; border:2px solid #fff; }
.btn i { margin-right:8px; }
.btn:hover { transform:translateY(-2px); }

.section { padding:48px 12px; background:#fff; border-radius:14px; margin:16px 0; }
.section h2 { font-size:1.9em; color:#0d47a1; text-align:center; margin:0 0 18px; }
.cards { display:flex; flex-wrap:wrap; gap:18px; justify-content:center; margin-top:16px; }
.card { flex:1 1 280px; max-width:340px; background:#fff; border-radius:14px; padding:22px; box-shadow:0 8px 24px rgba(0,0,0,0.08); text-align:center; transition: transform .2s; }
.card:hover { transform:translateY(-4px); }
.card i { font-size:1.8em; color:#0d47a1; margin-bottom:8px; }

.cta { text-align:center; background:#0d47a1; color:#fff; border-radius:14px; padding:48px 16px; margin-top:28px; }
.cta .btn-primary { background:#ffcc00; color:#0d47a1; }

@media(max-width:768px){
  .hero h1 { font-size:1.7em; }
  .btn { display:block; width:90%; max-width:300px; margin:10px auto; }
  .cards { flex-direction:column; align-items:center; }
}
</style>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

<!-- Config Firebase -->
<script>
const firebaseConfig = {
  apiKey: "AIzaSyCxna2jjk_5BKXnsCmJmwFsM388DeFUcNQ",
  authDomain: "brs-riche-2.firebaseapp.com",
  projectId: "brs-riche-2",
  storageBucket: "brs-riche-2.appspot.com",
  messagingSenderId: "313874599780",
  appId: "1:313874599780:web:TON_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Constantes
const DAILY_RATE = 0.02;
const REFERRAL_LEVELS = [0.15, 0.05, 0.05];

// Cr√©ation automatique des documents
async function setupUser(user) {
  if(!user) return;
  const userRef = db.collection("users").doc(user.uid);
  const userDoc = await userRef.get();
  if(!userDoc.exists){
    await userRef.set({
      email: user.email,
      username: user.displayName || user.email.split('@')[0],
      role: "user",
      balanceAvailable: 0,
      balanceWithdrawn: 0,
      balanceTotal: 0,
      sponsor: null,
      createdAt: firebase.firestore.FieldValue.serverTimestamp()
    });
  }

  const walletRef = db.collection("wallets").doc(user.uid);
  if(!(await walletRef.get()).exists){
    await walletRef.set({ balance:0, lastAppliedAt: firebase.firestore.FieldValue.serverTimestamp() });
  }

  const txRef = db.collection("transactions").doc(user.uid).collection("items");
  if((await txRef.get()).empty){
    await txRef.add({ type:"init", amount:0, createdAt:firebase.firestore.FieldValue.serverTimestamp() });
  }

  const referralsRef = db.collection("referrals").doc(user.uid).collection("items");
  if((await referralsRef.get()).empty){
    for(let i=1;i<=3;i++){
      await referralsRef.add({ level:i, referredUserId:null });
    }
  }

  console.log("‚úÖ Firestore setup termin√© pour :", user.email);
}

async function deposit(userUid, amount){
  const refWallet = db.collection('wallets').doc(userUid);
  const refTx = db.collection('transactions').doc(userUid).collection('items').doc();
  await db.runTransaction(async t=>{
    const snap = await t.get(refWallet);
    let bal = snap.exists ? Number(snap.data().balance||0) : 0;
    bal += amount;
    t.set(refWallet,{balance:bal,lastAppliedAt:firebase.firestore.FieldValue.serverTimestamp()},{merge:true});
    t.set(refTx,{type:'deposit',amount:amount,createdAt:firebase.firestore.FieldValue.serverTimestamp()});

    let currentReferrer = (await db.collection('users').doc(userUid).get()).data().sponsor;
    for(let i=0;i<3 && currentReferrer;i++){
      const parentWalletRef = db.collection('wallets').doc(currentReferrer);
      const parentTxRef = db.collection('transactions').doc(currentReferrer).collection('items').doc();
      const parentSnap = await t.get(parentWalletRef);
      let parentBal = parentSnap.exists ? Number(parentSnap.data().balance||0) : 0;
      const commission = amount * REFERRAL_LEVELS[i];
      parentBal += commission;
      t.set(parentWalletRef,{balance:parentBal},{merge:true});
      t.set(parentTxRef,{type:'referral_bonus',amount:commission,level:i+1,createdAt:firebase.firestore.FieldValue.serverTimestamp()});
      const parentData = await db.collection('users').doc(currentReferrer).get();
      currentReferrer = parentData.data().sponsor;
    }
  });
}

async function applyGains(userUid){
  const refWallet = db.collection('wallets').doc(userUid);
  const refTx = db.collection('transactions').doc(userUid).collection('items').doc();
  await db.runTransaction(async t=>{
    const snap = await t.get(refWallet);
    if(!snap.exists) throw new Error("Portefeuille inexistant");
    let bal = Number(snap.data().balance||0);
    const last = snap.data().lastAppliedAt?.toDate?.() || new Date();
    const now = new Date();
    const days = Math.max(1, Math.floor((now - last)/(1000*60*60*24)));
    const gain = bal*DAILY_RATE*days;
    bal += gain;
    t.update(refWallet,{balance:bal,lastAppliedAt:firebase.firestore.FieldValue.serverTimestamp()});
    t.set(refTx,{type:'profit',amount:Number(gain.toFixed(2)),createdAt:firebase.firestore.FieldValue.serverTimestamp()});
  });
}

// Surveiller l'√©tat auth
auth.onAuthStateChanged(user=>{
  setupUser(user);
});
</script>

</head>
<body>

<div id="home-container">

  <header class="hero">
    <h1>üåç Bienvenue sur <span style="color:#ffcc00;">BRS Riche 2</span></h1>
    <p>Une nouvelle mani√®re d'investir : simple, s√©curis√© et accessible √† tous üöÄ</p>
    <a href="register.html" class="btn btn-primary"><i class="fas fa-user-plus"></i>Cr√©er un compte</a>
    <a href="login.html" class="btn btn-outline"><i class="fas fa-sign-in-alt"></i>D√©j√† membre ? Connexion</a>
  </header>

  <section class="section">
    <h2>üöÄ Qui sommes-nous ?</h2>
    <p><strong>BRS Riche 2</strong> est une plateforme innovante qui transforme l‚Äôinvestissement en une exp√©rience simple et transparente.</p>
  </section>

  <section class="section">
    <h2>üõ†Ô∏è Notre Technologie</h2>
    <div class="cards">
      <div class="card"><i class="fas fa-shield-alt"></i><h3>S√©curit√© Blockchain</h3><p>Vos d√©p√¥ts sont prot√©g√©s et tra√ßables.</p></div>
      <div class="card"><i class="fas fa-cogs"></i><h3>Smart Contracts</h3><p>Gains calcul√©s automatiquement.</p></div>
      <div class="card"><i class="fas fa-chart-line"></i><h3>Dashboard</h3><p>Suivez vos gains et transactions en temps r√©el.</p></div>
      <div class="card"><i class="fas fa-dollar-sign"></i><h3>Paiements USDT</h3><p>Retirez vos gains en crypto stable.</p></div>
    </div>
  </section>

  <section class="cta">
    <h2>üì≤ Commencez aujourd‚Äôhui !</h2>
    <a href="register.html" class="btn btn-primary"><i class="fas fa-user-plus"></i>Cr√©er votre compte</a>
    <a href="login.html" class="btn btn-outline"><i class="fas fa-sign-in-alt"></i>D√©j√† membre ? Connexion</a>
  </section>

  <footer style="text-align:center;margin-top:32px;color:#777;">
    ¬© 2025 BRS Riche 2
  </footer>

</div>
</body>
</html>
